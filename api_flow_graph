// RAG API Control Flow
digraph {
	rankdir=TB
	start [label="Start: POST /query" shape=oval]
	init_check [label="Check: rag_system is None?" shape=diamond]
	err_500_init [label="Return 500: Init Error" color=red shape=box]
	try_block [label="Try: full_pipeline(query)" shape=box]
	retrieve [label="Func: retrieve()" shape=component]
	generate [label="Func: generate()" shape=component]
	success [label="Return 200: JSON Result" color=green shape=oval]
	except_block [label="Except: Exception caught" shape=diamond]
	err_500_runtime [label="Return 500: Runtime Error" color=red shape=box]
	start -> init_check
	init_check -> err_500_init [label=True]
	init_check -> try_block [label=False]
	try_block -> retrieve
	retrieve -> generate
	generate -> success
	try_block -> except_block [label=Error style=dashed]
	retrieve -> except_block [label=Error style=dashed]
	generate -> except_block [label=Error style=dashed]
	except_block -> err_500_runtime
}
